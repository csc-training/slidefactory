BootStrap: library
From: ubuntu:20.04
MirrorURL: http://fi.archive.ubuntu.com/ubuntu

%setup
        mkdir -p      $SINGULARITY_ROOTFS/slidetools/filter
        mkdir         $SINGULARITY_ROOTFS/slidetools/theme
        cp convert.py $SINGULARITY_ROOTFS/slidetools/
        cp filter/*   $SINGULARITY_ROOTFS/slidetools/filter/
        cp -r theme/* $SINGULARITY_ROOTFS/slidetools/theme/
        
%post
        apt update && apt install -y software-properties-common
        apt update && add-apt-repository universe && apt update
        apt install -y python3-pip pandoc python3-pandocfilters
        apt install -y fonts-noto fonts-inconsolata
        apt install -y cabal-install nvi
        cabal update
        cabal install pandoc-types-1.17.5.4
        cabal install pandoc-emphasize-code
        apt-get remove -y --autoremove cabal-install

%runscript
        exec python3 /slidetools/convert.py "$@"
